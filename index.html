<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <title>Resurgence Map Calculator</title>
    <style>
        html,body { margin:0; padding:0; height:100%; width:100%; box-sizing:border-box; }
        body {
            display:flex;
            flex-direction:column;
            height:100vh; width:100vw;
            background:#1a1a1a; color:#fff; font-family:sans-serif; overflow:hidden;
        }
        #topbar {
            background:#232; color:#fff;
            display:flex; flex-direction:column; align-items:center; justify-content:center;
            gap:6px;
            border-bottom:1px solid #333;
            min-height:120px;
            height:25vh;
            width:100vw;
            box-sizing:border-box;
            z-index:20;
            position:relative;
            padding:18px 8px 6px 8px;
        }
        .mini-title {
            font-size:2.8rem;
            color:#6AD44C;
            letter-spacing:2px;
            font-weight:bold;
            text-transform:uppercase;
            user-select:none;
            opacity:.98;
            line-height:1.1;
            margin-bottom:2px;
        }
        .sub-title {
            font-size:1.35rem;
            color:#aaa;
            margin-top:0.5em;
            line-height:1.2;
            text-align:center;
        }
        .button-group {
            display:flex; flex-direction:row; gap:24px; width:auto; align-items:center; margin:18px 0 0 0;
            justify-content:center;
        }
        .ctrl-ico {
            width:72px; height:72px; min-width:72px; min-height:72px;
            border:none; outline:none; border-radius:50%;
            cursor:pointer;
            display:flex; align-items:center; justify-content:center;
            background:#252525;
            transition:background .13s, box-shadow .13s, transform .11s;
            font-size:2.4rem;
            margin:0 0;
            box-sizing:border-box;
            box-shadow:0 4px 18px #0004;
        }
        .ctrl-ico:hover, .ctrl-ico:active { background:#363; box-shadow:0 6px 22px #161b; transform:scale(1.06);}
        .ctrl-ico[data-color="gold"] { background:#4e4010; color:#ffe700;}
        .ctrl-ico[data-color="green"] { background:#2b4d24; color:#6AD44C;}
        .ctrl-ico[data-color="blue"] { background:#273651; color:#7bdfff;}
        .ctrl-ico[data-color="gray"] { background:#444; color:#fff;}
        #cal-info {
            font-size:1.1rem;
            padding:4px 10px;
            background:#000a; color:#6AD44C;
            border-radius:8px;
            min-height:32px; max-width:68px; box-sizing:border-box;
            text-align:center;
            border:1.7px solid #3b403a;
            margin-left:16px;
            margin-right:0;
            margin-top:0;
            line-height:1.25;
            font-family:'Courier New',Courier,monospace;
            overflow:hidden;
            white-space:nowrap;
        }
        @media (max-width:1200px) {
            #topbar { min-height:90px; height:18vh; padding:12px 6px 4px 6px;}
            .mini-title { font-size:2.2rem; }
            .ctrl-ico { width:58px; height:58px; min-width:58px; min-height:58px; font-size:1.8rem;}
            .button-group { gap:16px; }
            #cal-info { font-size:0.93rem; min-height:22px; max-width:58px;}
            .sub-title { font-size:1.04rem; }
        }
        @media (max-width:800px) {
            #topbar { min-height:70px; height:16vh; padding:6px 3px 2px 3px;}
            .mini-title { font-size:1.58rem; }
            .ctrl-ico { width:42px; height:42px; min-width:42px; min-height:42px; font-size:1.18rem;}
            .button-group { gap:9px; }
            #cal-info { font-size:0.7rem; min-height:14px; max-width:38px;}
            .sub-title { font-size:0.82rem; }
        }
        @media (max-width:550px) {
            #topbar { min-height:62px; height:14vh; padding:2px 1px 0 1px;}
            .mini-title { font-size:1.15rem; }
            .sub-title { font-size:0.61rem; }
            .ctrl-ico { width:32px; height:32px; min-width:32px; min-height:32px; font-size:0.9rem;}
            .button-group { gap:3px;}
            #cal-info { font-size:0.5rem; min-height:10px; max-width:27px; padding:1px;}
        }
        #map-viewport { flex-grow:1; overflow:hidden; background:#000; position:relative; touch-action:none; }
        canvas { display:block; touch-action:none; }
    </style>
</head>
<body>
<div id="topbar">
    <div class="mini-title">RMC To GO</div>
    <div class="sub-title">Made By Phoxphor</div>
    <div class="button-group">
        <button class="ctrl-ico" title="Add Airdrop" data-color="gold" onclick="addAirdrop()">&#x1F4E6;</button>
        <button class="ctrl-ico" title="Find Nearest" data-color="green" onclick="findNearest()">&#x1F50E;</button>
        <button class="ctrl-ico" title="Toggle Icons" data-color="gray" onclick="toggleVisibility()">&#x1F5FA;</button>
        <button class="ctrl-ico" title="Reset Map" data-color="blue" onclick="resetMap()">&#x21BB;</button>
    </div>
</div>
<div id="map-viewport">
    <canvas id="mapCanvas"></canvas>
</div>
<script src="index.js"></script>
<script>
// --- Ensure default centering on load ---
window.addEventListener("DOMContentLoaded",()=> {
    if(typeof centerToZeroZero==="function") { centerToZeroZero(); }
    else {
        if(window.mapImg&&mapImg.width) { 
            setMapViewToZeroZero();
        } 
        else {
            // fallback: check again after map loads
            let img=document.querySelector('img,canvas');
            img&&img.addEventListener('load',setMapViewToZeroZero,{once:true});
        }
    }
});
// Helper for centering to (0,0) - tries to work with main var/view logic
function setMapViewToZeroZero(smooth=0){
    try{
        let canvas=document.getElementById('mapCanvas');
        let map=window.mapImg;
        if(!map||!canvas) return;
        let v=window.targetView||window.view;
        let zmin=(window.MIN_ZOOM)||0.8;
        let zmax=(window.MAX_ZOOM)||2;
        let zoom=window.targetView && window.targetView.zoom || zmin;
        let cx=canvas.width/2,cy=canvas.height/2;
        let mx=map.width/2,my=map.height/2;
        let zx=zoom;
        let x=cx-mx*zx,y=cy-my*zx;

        function updateView(_x,_y,_z) {
            if(window.targetView) { targetView.x=_x;targetView.y=_y;targetView.zoom=_z;}
            if(window.view) { view.x=_x;view.y=_y;view.zoom=_z;}
            if(typeof clampView==="function")clampView();
            if(typeof render==="function")render();
        }
        if(smooth>0 && window.targetView){
            let steps=14,cur=0,_x=v.x,_y=v.y,_z=v.zoom;
            let dx=(x-_x)/steps,dy=(y-_y)/steps,dz=(zoom-_z)/steps;
            let anim=()=>{ if(cur<steps){_x+=dx;_y+=dy;_z+=dz;updateView(_x,_y,_z);cur++;setTimeout(anim,12);}else{updateView(x,y,zoom);} };
            anim();
        }else{
            updateView(x,y,zoom);
        }
    }catch(e){}
}
// Expose for index.js usage or fallback
window.centerToZeroZero=()=>setMapViewToZeroZero(0);
</script>
</body>
</html>
